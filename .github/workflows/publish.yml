name: ğŸš€ AGRO_TECH Auto Publish

# ÙŠØ¹Ù…Ù„ Ø§Ù„Ø£ÙƒØ´Ù† Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„ÙØ±Ø¹ main
on:
  push:
    branches: [ main ]

jobs:
  build-and-push:
    runs-on: ubuntu-latest
    # Ø±Ø¨Ø· Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ØªÙŠ ÙˆØ¬Ø¯ØªÙ‡Ø§ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø³ØªÙˆØ¯Ø¹Ùƒ
    environment: production 
    
    steps:
      - name: ğŸ“¥ Ø³Ø­Ø¨ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ¯Ø±ÙŠ
        uses: actions/checkout@v4

      - name: ğŸ”‘ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ GitHub Packages
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GH_TOKEN }} # ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø£Ø¶ÙØª Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù… ÙÙŠ Secrets

      - name: ğŸ—ï¸ Ø¨Ù†Ø§Ø¡ ÙˆØ±ÙØ¹ ØµÙˆØ±Ø© Docker
        uses: docker/build-push-action@v5
        with:
          context: .
          push: true
          # Ø³ÙŠØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ø§Ø³Ù…Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ectroshop9 Ø¢Ù„ÙŠØ§Ù‹
          tags: |
            ghcr.io/${{ github.repository }}:latest
            ghcr.io/${{ github.repository }}:${{ github.sha }}